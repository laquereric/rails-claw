<% content_for(:title) { "Conversation - Rails-Claw" } %>

<div class="space-y-6">
  <div class="flex justify-between items-center">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Conversation</h1>
      <p class="text-sm text-gray-500">
        Agent: <%= @conversation.agent.name %> |
        Platform: <%= @conversation.platform %> |
        <%= @messages.count %> messages
      </p>
    </div>
    <%= link_to "Back", workspace_conversations_path(@workspace), class: "inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" %>
  </div>

  <div class="bg-white shadow rounded-lg p-6">
    <div class="space-y-4">
      <% @messages.each do |message| %>
        <div class="flex gap-3 <%= message.role == 'assistant' ? '' : 'flex-row-reverse' %>">
          <div class="shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium text-white
            <%= case message.role
                when 'user' then 'bg-blue-500'
                when 'assistant' then 'bg-green-500'
                when 'system' then 'bg-gray-500'
                end %>">
            <%= message.role[0].upcase %>
          </div>
          <div class="max-w-2xl rounded-lg p-3 text-sm
            <%= message.role == 'user' ? 'bg-blue-50' : 'bg-gray-50' %>">
            <p class="text-gray-900"><%= message.content %></p>
            <% if message.tokens_used || message.latency_ms %>
              <p class="mt-1 text-xs text-gray-400">
                <% if message.tokens_used %>tokens: <%= message.tokens_used %><% end %>
                <% if message.latency_ms %> | latency: <%= message.latency_ms %>ms<% end %>
              </p>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
